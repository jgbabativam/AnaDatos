---
title: "Analítica de datos aplicada a estudios sobre desarrollo"
subtitle: "Análisis de Regresión"
author: "[Giovany Babativa, PhD](http://jgbabativam.rbind.io/)"
format: 
  gbabativa-revealjs:
    footer: "Diapositivas disponibles en [GitHub](https://github.com/jgbabativam)."
incremental: false
embed-resources: true
highlight-style: dracula
---

```{css, echo=FALSE}
.my_class1 {
height: 200px;
width: 100px;
}

.my_class2 {
height: 100px;
width: 200px;
}
```

## Sobre Mi

> Puedes encontrarme en:

- {{< ai google-scholar >}} [Google scholar](https://scholar.google.es/citations?user=2NJRNg8AAAAJ&hl=es)
- {{< fa brands github >}} [GitHub. https://github.com/jgbabativam](https://github.com/jgbabativam)
- {{< fa brands linkedin >}} [linkedin](https://www.linkedin.com/in/giovany-babativa-marquez/?originalSubdomain=co)
- {{< fa solid envelope >}} jgbabativam@unal.edu.co


## Proceso de analítica


```{r, out.width= '100%'}
knitr::include_graphics(here::here("images/Ciclo.png"))
```
[Wickham, H. y otros (2023)](https://r4ds.hadley.nz/)

# MÉTODOS MULTIVARIANTES {background-color="#0077b6"}

## Modelos de analítica

```{r,  out.width= '110%'}
knitr::include_graphics(here::here("images/Metodos.png"))
```

## Modelando datos

Lo primero es identificar el tipo de relación: lineal o no lineal


. . .


![](images/Regresion.png){fig-align="center"}

. . .


Correlación de Pearson, gráficos de dispersión simples o matricial.


## Medidas bidimensionales


- **Covarianza**: Mide el grado de asociación lineal entre dos variables. Los valores que toma dependen de las unidades de medida de las variables, no están acotados.

. . .

- **Correlación**: Mide el grado de asociación lineal entre dos variables. Toma valores entre -1 y 1. El signo indica si la relación es positiva o negativa.

. . .

- **Gráfico de dispersión**: Ilustra sobre cómo es la relación entre dos variables (la forma y la fuerza de la relación). Los datos son pares de medidas para cada individuo.

## Correlación lineal

![](images/Correlacion1.png){fig-align="center"}

## Otros tipos de asociación

Una Correlación de **CERO** no debe interpretarse como "No existe asociación", solo permite concluir que no hay asociación **lineal** pero puede existir una relación de otro tipo. Por ejemplo, Salario Vs. Experiencia. Otro aspecto a considerar es la presencia de datos atípicos ("raros") que puedan ser influyentes.


![](images/nolineal1.png){fig-align="left"}
![](images/nolineal2.png){fig-align="right"}

## El entorno `tidyverse`

![](images/tidyverse.png){fig-align="center"}

## Flujo de trabajo

![](images/tidyverse2.png){fig-align="center"}

## La gramática de las gráficas 


Requiere de al menos 3 elementos:
 
 - Datos
 - _aesthetics_: variables.
 - geometría
 
. . .

```{r}
#| eval: false
#| echo: true

ggplot(data = datos, aes(x = _, y = _)) +
  geom_point()
```


## Ejemplo

Usemos un conjunto de datos estándar del paquete `modelr`

```{r}
#| echo: true
library(pacman)
p_load(tidyverse, broom, modelr, 
       skimr, corrplot)

datos <- heights 
```

. . . 

Ahora explore el conjunto de datos usando las funciones `glimpse()` y `skim()` y discuta la salida

. . .

```{r}
#| eval: false
#| echo: true
glimpse(datos)
skim(datos)
```

. . .

Haga un diagrama de dispersión estre la estatura y el peso, el ingreso y la edad, el ingreso y los años de educación por sexo


## Diagramas de dispersión

::: panel-tabset
## Diagrama 1

```{r, fig.height=4}
#| eval: true
#| echo: true

ggplot(data = datos, aes(x = height, y = weight)) +
  geom_point() +
  labs(x = 'Estatura', y = 'Peso')
```
## Diagrama 2

```{r, fig.height=4}
#| eval: true
#| echo: true

ggplot(data = datos, aes(x = income, y = age)) +
  geom_point(color = "lightblue", alpha=0.1) +
  labs(x = 'Ingreso', y = 'Edad') +
  theme_bw() 
```

## Diagrama 3

```{r, fig.height=4}
#| eval: true
#| echo: true

ggplot(data = datos, aes(x = income, y = education)) +
  geom_point(color = "lightblue", alpha=0.1) +
  labs(x = 'Ingreso', y = 'Educación') +
  theme_bw() +
  facet_wrap(~sex, ncol = 2)
```


:::

## Correlación

La correlación mide el grado de asociación lineal y se calcula usando la función `cor()`, también se pueden representar gráficamente usando paquetes como `corrplot`

::: panel-tabset

## Correlación

```{r}
#| eval: true
#| echo: true
vars <- datos |> select(height, weight, income, age, education)

cor(vars, use = "complete")
```

## Gráfico

```{r}
#| eval: true
#| echo: true
vars <- datos |> select(height, weight, income, age, education)

r <- cor(vars, use = "complete")
corrplot(r)
# vignette("corrplot-intro")
```


::: 
## You can add R code

```{r}
#| echo: true
library(dplyr)
library(ggplot2)
g <- starwars |> 
  ggplot() +
  geom_point(aes(x = height, y = mass)) +
  theme_light()
```

## And show the results aswell :)

```{r}
#| fig.align: center
#| echo: true
g 
```

## What about tables? {.smaller}

### `knitr::kable()`

::: columns
::: {.column width="50%"}
```{r}
#| label: kable-ex
#| echo: true
#| eval: false
tab <- starwars |>
  tidyr::drop_na(species) |> 
  group_by(species) |>
  summarise(
    n = n(),
    mean_heigth = round(mean(height, na.rm = TRUE)),
    mean_mass = round(mean(mass, na.rm = TRUE))
  ) |> 
  slice_max(order_by = n, n = 4) 

knitr::kable(tab)
```
:::

::: {.column width="50%"}
```{r}
#| label: kable-ex
#| eval: true
```
:::
:::

## `DT::datatable()` {.smaller}

With the `smaller` class in the slide!
Ex: `## slide name {.smaller}`

```{r}
DT::datatable(tab, options = list(pageLength = 5))
```

## `gt::gt()`

```{r}
gt::gt(tab)
```

## `reactable::reactable()`

```{r}
reactable::reactable(tab)
```

## Diagrams with Mermaid!

Read about how to create a diagram in this [post by Mine Çetinkaya-Rundel](https://mine-cetinkaya-rundel.github.io/quarto-tip-a-day/posts/21-diagrams/).

<center>
<blockquote class="twitter-tweet" data-conversation="none"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/quartotip?src=hash&amp;ref_src=twsrc%5Etfw">#quartotip</a> 21: Create diagrams in Quarto documents using Mermaid or Graphviz in executable code cells, similar to how you create figures.<br><br>Read more: <a href="https://t.co/3qx9oSNCay">https://t.co/3qx9oSNCay</a> <a href="https://t.co/fYzGcISl4h">pic.twitter.com/fYzGcISl4h</a></p>&mdash; Quarto (@quarto_pub) <a href="https://twitter.com/quarto_pub/status/1549271325943947270?ref_src=twsrc%5Etfw">July 19, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>


## Exporting into PDF

You can use the function `pagedown::chrome_print()` to print the HTML version into a PDF!

```r
pagedown::chrome_print("path-to-file.html")
```